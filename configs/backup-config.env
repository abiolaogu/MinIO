# MinIO Enterprise - Backup Configuration
# ==================================================
# This file contains configuration for automated backups
# Source this file before running backup scripts or use it with systemd/cron

# Backup Destination
# --------------------------------------------------
# Directory where backups will be stored
BACKUP_DESTINATION=/var/backups/minio

# Backup Type
# --------------------------------------------------
# Options: full, incremental
# full - Complete backup of all data
# incremental - Only backup changes since last backup
BACKUP_TYPE=full

# Retention Policy
# --------------------------------------------------
# Number of days to keep backups before automatic cleanup
BACKUP_RETENTION_DAYS=30

# Compression
# --------------------------------------------------
# Enable/disable compression of backup files
# Options: true, false
BACKUP_COMPRESSION_ENABLED=true

# Encryption
# --------------------------------------------------
# Enable/disable encryption of backup files
# Options: true, false
BACKUP_ENCRYPTION_ENABLED=false

# GPG encryption key path (required if encryption is enabled)
# Path to GPG public key for encryption
BACKUP_GPG_KEY_PATH=/etc/minio/backup-keys/public.gpg

# Verification
# --------------------------------------------------
# Enable/disable backup verification after creation
# Options: true, false
VERIFY_BACKUP=true

# Database Configuration - PostgreSQL
# --------------------------------------------------
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=minio
POSTGRES_DB=minio
# Note: Use .pgpass file or PGPASSWORD environment variable for password
# Never commit passwords to version control

# Database Configuration - Redis
# --------------------------------------------------
REDIS_HOST=localhost
REDIS_PORT=6379
# Note: Set REDIS_PASSWORD environment variable if Redis requires authentication

# MinIO Configuration
# --------------------------------------------------
MINIO_DATA_DIR=/data
MINIO_CONFIG_DIR=/etc/minio

# Notification Configuration (Optional)
# --------------------------------------------------
# Email notification settings
BACKUP_NOTIFY_EMAIL=false
BACKUP_NOTIFY_EMAIL_TO=admin@example.com
BACKUP_NOTIFY_EMAIL_FROM=backup@minio.local

# Slack notification settings
BACKUP_NOTIFY_SLACK=false
BACKUP_NOTIFY_SLACK_WEBHOOK=https://hooks.slack.com/services/YOUR/WEBHOOK/URL

# Remote Backup Storage (Optional)
# --------------------------------------------------
# Enable remote backup copy (e.g., to S3, another server)
BACKUP_REMOTE_ENABLED=false
BACKUP_REMOTE_TYPE=s3  # Options: s3, rsync, scp
BACKUP_REMOTE_DESTINATION=s3://my-backup-bucket/minio-backups/

# S3 configuration (if BACKUP_REMOTE_TYPE=s3)
BACKUP_S3_ENDPOINT=https://s3.amazonaws.com
BACKUP_S3_ACCESS_KEY=
BACKUP_S3_SECRET_KEY=
BACKUP_S3_REGION=us-east-1

# Logging
# --------------------------------------------------
# Log level for backup operations
# Options: DEBUG, INFO, WARNING, ERROR
BACKUP_LOG_LEVEL=INFO

# Performance Tuning
# --------------------------------------------------
# Number of parallel compression threads
BACKUP_COMPRESSION_THREADS=4

# PostgreSQL backup format
# Options: p (plain SQL), c (custom), d (directory), t (tar)
POSTGRES_BACKUP_FORMAT=p

# PostgreSQL backup options
POSTGRES_BACKUP_OPTS="--no-owner --no-acl"

# Advanced Options
# --------------------------------------------------
# Enable incremental backups with timestamps
BACKUP_INCREMENTAL_ENABLED=false

# Create backup manifest file
BACKUP_CREATE_MANIFEST=true

# Calculate and store checksums
BACKUP_CALCULATE_CHECKSUMS=true

# Maintenance Window
# --------------------------------------------------
# Preferred backup time (24-hour format)
BACKUP_PREFERRED_HOUR=02
BACKUP_PREFERRED_MINUTE=00

# Maximum backup duration (in minutes)
BACKUP_MAX_DURATION=120

# Alerts and Monitoring
# --------------------------------------------------
# Fail backup if duration exceeds maximum
BACKUP_FAIL_ON_TIMEOUT=true

# Alert if backup size differs significantly from previous backup
BACKUP_ALERT_SIZE_CHANGE_PERCENT=50

# Alert if backup age exceeds threshold (in hours)
BACKUP_ALERT_AGE_THRESHOLD=26
