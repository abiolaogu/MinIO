#!/bin/bash
# MinIO Enterprise Backup Configuration
# =====================================
# This file contains configuration for backup operations

# Backup Settings
BACKUP_ROOT_DIR="${BACKUP_ROOT_DIR:-/var/backups/minio-enterprise}"
BACKUP_RETENTION_DAYS="${BACKUP_RETENTION_DAYS:-30}"
BACKUP_COMPRESSION="${BACKUP_COMPRESSION:-true}"
BACKUP_ENCRYPTION="${BACKUP_ENCRYPTION:-false}"
BACKUP_VERIFICATION="${BACKUP_VERIFICATION:-true}"

# Backup Types
ENABLE_FULL_BACKUP="${ENABLE_FULL_BACKUP:-true}"
ENABLE_INCREMENTAL_BACKUP="${ENABLE_INCREMENTAL_BACKUP:-false}"

# Components to Backup
BACKUP_MINIO_DATA="${BACKUP_MINIO_DATA:-true}"
BACKUP_POSTGRESQL="${BACKUP_POSTGRESQL:-true}"
BACKUP_REDIS="${BACKUP_REDIS:-true}"
BACKUP_CONFIG_FILES="${BACKUP_CONFIG_FILES:-true}"
BACKUP_MONITORING_DATA="${BACKUP_MONITORING_DATA:-false}"

# Docker Settings
DOCKER_COMPOSE_FILE="${DOCKER_COMPOSE_FILE:-./deployments/docker/docker-compose.production.yml}"
POSTGRES_CONTAINER="${POSTGRES_CONTAINER:-postgres}"
REDIS_CONTAINER="${REDIS_CONTAINER:-redis}"
MINIO_CONTAINERS="${MINIO_CONTAINERS:-minio1 minio2 minio3 minio4}"

# PostgreSQL Settings
POSTGRES_DB="${POSTGRES_DB:-minio_enterprise}"
POSTGRES_USER="${POSTGRES_USER:-minio}"
POSTGRES_PASSWORD="${POSTGRES_PASSWORD:-minio_secure_password}"

# Redis Settings
REDIS_RDB_FILE="${REDIS_RDB_FILE:-dump.rdb}"
REDIS_AOF_FILE="${REDIS_AOF_FILE:-appendonly.aof}"

# MinIO Settings
MINIO_DATA_VOLUMES="${MINIO_DATA_VOLUMES:-minio1-data minio2-data minio3-data minio4-data}"
MINIO_CACHE_VOLUMES="${MINIO_CACHE_VOLUMES:-minio1-cache minio2-cache minio3-cache minio4-cache}"

# Notification Settings
ENABLE_EMAIL_NOTIFICATION="${ENABLE_EMAIL_NOTIFICATION:-false}"
EMAIL_RECIPIENT="${EMAIL_RECIPIENT:-admin@example.com}"
EMAIL_SUBJECT_PREFIX="${EMAIL_SUBJECT_PREFIX:-[MinIO Backup]}"

# S3 Remote Backup Settings (optional)
S3_BACKUP_ENABLED="${S3_BACKUP_ENABLED:-false}"
S3_BUCKET="${S3_BUCKET:-}"
S3_ENDPOINT="${S3_ENDPOINT:-}"
S3_ACCESS_KEY="${S3_ACCESS_KEY:-}"
S3_SECRET_KEY="${S3_SECRET_KEY:-}"

# Logging
LOG_DIR="${LOG_DIR:-./logs/backup}"
LOG_LEVEL="${LOG_LEVEL:-INFO}"  # DEBUG, INFO, WARN, ERROR

# Parallel Processing
PARALLEL_JOBS="${PARALLEL_JOBS:-4}"

# Compression Settings
COMPRESSION_LEVEL="${COMPRESSION_LEVEL:-6}"  # 1-9, higher = better compression, slower
COMPRESSION_TOOL="${COMPRESSION_TOOL:-gzip}"  # gzip, bzip2, xz

# Encryption Settings (if enabled)
ENCRYPTION_KEY_FILE="${ENCRYPTION_KEY_FILE:-}"
ENCRYPTION_ALGORITHM="${ENCRYPTION_ALGORITHM:-aes-256-cbc}"

# Health Check
BACKUP_HEALTH_CHECK_URL="${BACKUP_HEALTH_CHECK_URL:-}"

# Maintenance
AUTO_CLEANUP_OLD_BACKUPS="${AUTO_CLEANUP_OLD_BACKUPS:-true}"
BACKUP_INTEGRITY_CHECK="${BACKUP_INTEGRITY_CHECK:-true}"
